
<p-table
  [value]="products"
  [lazy]="true"
  (onLazyLoad)="fetchData()"
  [scrollable]="true"
  [responsive]="true"
  [resizableColumns]="true"
  styleClass="p-datatable-striped"
>
  <ng-template pTemplate="caption">
    <div class="flex align-items-center justify-content-between">
      Products
      <p-button icon="pi pi-refresh" (onClick)="fetchData()"></p-button>
    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th>Title</th>
      <th>Active</th>
      <th>Price</th>
      <th>Discount</th>
      <th>Quantity</th>
      <th>Attributes</th>
      <th>.</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-product>
    <tr>
      <td>{{product.title['ua']}}</td>
      <td><p-tag [value]="getTitleForActive(product.active)" [severity]="getSeverityForActive(product.active)"></p-tag></td>
      <td>{{product.price | currency: product.currency}}</td>
      <td>{{product.discount}}%</td>
      <td>{{product.quantity}}</td>
      <td>
        <p-tag *ngFor="let attr of attrStrings.get(product)">
          {{attr}}
        </p-tag>
      </td>
      <td class="flex flex-wrap gap-3 justify-content-end">
        <p-button
          icon="pi pi-pencil"
          routerLink="/edit-product"
          [queryParams]="{id: product.id}"
        ></p-button>
        <p-button
          icon="pi pi-times"
          styleClass="p-button-danger"
          (onClick)="deleteProduct(product.id)"
        ></p-button>
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="summary">
    <div class="flex align-items-center justify-content-between">
      In total there are {{products ? products.length : 0 }} products.
    </div>
  </ng-template>
</p-table>
